<!doctype html>
<html>
<head>
    <title>Horse race</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/modernizr.js" type="text/javascript"></script>
    <script>
        var run1 = 0;
        var run2 = 0;
        var run3 = 0;
        var run4 = 0;
        var run5 = 0;
        var run6 = 0;
        var finish1 = 0;
        var finish2 = 0;
        var finish3 = 0;
        var finish4 = 0;
        var finish5 = 0;
        var finish6 = 0;

        var width1 = 100, width2 = 100, width3 = 100, width4 = 100, width5 = 100, width6 = 100, width_h = 100;
        var psy = 0, psy1 = 0, psy2 = 0, psy3 = 0, psy4 = 0, psy5 = 0, psy6 = 0;

        checkRace = function () {
            let goal = 500;

            if (run1 > 1300 && finish1 < 1) {
                finish1 = 1;
                setTimeout(() => console.log($("#name1").val()), goal);
                $("#ranking").append("<li>" + $("#name1").val() + "</li>")
            }
            if (run2 > 1300 && finish2 < 1) {
                finish2 = 1;
                setTimeout(() => console.log($("#name2").val()), goal);
                $("#ranking").append("<li>" + $("#name2").val() + "</li>")
            }
            if (run3 > 1300 && finish3 < 1) {
                finish3 = 1;
                setTimeout(() => console.log($("#name3").val()), goal);
                $("#ranking").append("<li>" + $("#name3").val() + "</li>")
            }
            if (run4 > 1300 && finish4 < 1) {
                finish4 = 1;
                setTimeout(() => console.log($("#name4").val()), goal);
                $("#ranking").append("<li>" + $("#name4").val() + "</li>")
            }
            if (run5 > 1300 && finish5 < 1) {
                finish5 = 1;
                setTimeout(() => console.log($("#name5").val()), goal);
                $("#ranking").append("<li>" + $("#name5").val() + "</li>")
            }
            if (run6 > 1300 && finish6 < 1) {
                finish6 = 1;
                setTimeout(() => console.log($("#name6").val()), goal);
                $("#ranking").append("<li>" + $("#name6").val() + "</li>")
            }
        }
        startRace = function () {
            let multi = 10;
            let delay = 40;
            playAlert = setInterval(function () {
                const meter1 = Math.random() * multi;
                if (run1 > 900 && psy != 1 ) {
                    width1 = width1 + meter1 / (multi / 4);
                    jQuery("#player1").css({"width": width1});
                    psy = 1;

                } else {
                    jQuery("#player1").css({"position": "relative", "top": "0px", "left": run1 + "px", width: width_h});
                    run1 = run1 + meter1;
                }
                if (psy == 1) {
                    jQuery("#player1").find("img").attr("src", "image/player_psy.gif");
                    psy1 = 2;
                }
                checkRace();
            }, delay);

            playAlert = setInterval(function () {
                const meter2 = Math.random() * multi;
                if (run2 > 900 && psy != 1) {
                    width2 = width2 + meter2 / (multi / 4);
                    jQuery("#player2").css({"width": width2});
                    if (psy == 0) {
                        psy = 1;
                    }
                } else {
                    jQuery("#player2").css({"position": "relative", "top": "0px", "left": run2 + "px", width: width_h});
                    run2 = run2 + meter2;
                }
                if (psy == 1) {
                    jQuery("#player2").find("img").attr("src", "image/player_psy.gif");
                    psy2 = 2;
                }
                checkRace();
            }, delay);

            playAlert = setInterval(function () {
                const meter3 = Math.random() * multi;
                if (run3 > 900 && psy != 1) {
                    width3 = width3 + meter3 / (multi / 4);
                    jQuery("#player3").css({"width": width3});
                    if (psy == 0) {
                        psy = 1;
                    }
                } else {
                    jQuery("#player3").css({"position": "relative", "top": "0px", "left": run3 + "px", width: width_h});
                    run3 = run3 + meter3;
                }
                if (psy == 1) {
                    jQuery("#player3").find("img").attr("src", "image/player_psy.gif");
                    psy3 = 2;
                }
                checkRace();
            }, delay);

            playAlert = setInterval(function () {
                const meter4 = Math.random() * multi;
                if (run4 > 900 && psy != 1) {
                    width4 = width4 + meter4 / (multi / 4);
                    jQuery("#player4").css({"width": width4});
                    if (psy == 0) {
                        psy = 1;
                    }
                } else {
                    jQuery("#player4").css({"position": "relative", "top": "0px", "left": run4 + "px", width: width_h});
                    run4 = run4 + meter4;
                }
                if (psy == 1) {
                    jQuery("#player4").find("img").attr("src", "image/player_psy.gif");
                    psy4 = 2;
                }
                checkRace();
            }, delay);

            playAlert = setInterval(function () {
                const meter5 = Math.random() * multi;
                if (run5 > 900 && psy != 1) {
                    width5 = width5 + meter5 / (multi / 4);
                    jQuery("#player5").css({"width": width5});
                    if (psy == 0) {
                        psy = 1;
                    }
                } else {
                    jQuery("#player5").css({"position": "relative", "top": "0px", "left": run5 + "px", width: width_h});
                    run5 = run5 + meter5;
                }
                if (psy == 1) {
                    jQuery("#player5").find("img").attr("src", "image/player_psy.gif");
                    psy5 = 2;
                }
                checkRace();
            }, delay);


            playAlert = setInterval(function () {
                const meter6 = Math.random() * multi;
                if (run6 > 900 && psy != 1) {
                    width6 = width6 + meter6 / (multi / 4);
                    jQuery("#player6").css({"width": width6});
                    if (psy == 0) {
                        psy = 1;
                    }
                } else {
                    jQuery("#player6").css({"position": "relative", "top": "0px", "left": run6 + "px", width: width_h});
                    run6 = run6 + meter6;
                }
                if (psy == 1) {
                    jQuery("#player6").find("img").attr("src", "image/player_psy.gif");
                    psy6 = 2;
                }
                checkRace();
            }, delay);

            $("#btn_start").hide();
        };
        // clearInterval(playAlert);
    </script>
</head>
<body>

<div id="player_rail">
    <div id="player1" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player1_name">1</span>
    </div>
    <div id="player2" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player2_name">2</span>
    </div>
    <div id="player3" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player3_name">3</span>
    </div>
    <div id="player4" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player4_name">4</span>
    </div>
    <div id="player5" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player5_name">5</span>
    </div>
    <div id="player6" style="width: 100px;">
        <img src="image/player_run.gif" width="100%"/>
        <span id="player6_name">6</span>
    </div>
</div>
<div id="winner_show">
    <ol id="ranking"></ol>
</div>
<div id="wrap">
    <div id="test">
        <br/><br/><br/><br/>
        <br/>
        <br/>
        F<br/>
        I<br/>
        N<br/>
        I<br/>
        S<br/>
        H<br/>
    </div>
</div>
<div id="names">
    <table>
        <tr>
            <td>1번 마: <input type="text" id="name1" value="일두현"/></td>
            <td>배팅금액: <input type="text" id="money1"/></td>
        </tr>
        <tr>
            <td>2번 마: <input type="text" id="name2" value="이두현"/></td>
            <td>배팅금액: <input type="text" id="money2"/></td>
        </tr>
        <tr>
            <td>3번 마: <input type="text" id="name3" value="삼두현"/></td>
            <td>배팅금액: <input type="text" id="money3"/></td>
        </tr>
        <tr>
            <td>4번 마: <input type="text" id="name4" value="사두현"/></td>
            <td>배팅금액: <input type="text" id="money4"/></td>
        </tr>
        <tr>
            <td>5번 마: <input type="text" id="name5" value="오두현"/></td>
            <td>배팅금액: <input type="text" id="money5"/></td>
        </tr>
        <tr>
            <td>6번 마: <input type="text" id="name6" value="육두현"/></td>
            <td>배팅금액: <input type="text" id="money6"/></td>
        </tr>
    </table>
</div>
<button id="btn_start" onclick="startRace()" class="styled">start race</button>
</body>
</html>